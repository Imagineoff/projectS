<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard bota</title>
  <meta name="description" content="Personalizovaný Discord bot dashboard">
  <meta property="og:image" content="https://raw.githubusercontent.com/Imagineoff/projectS/main/IMG_2609.jpeg">
  <meta property="og:title" content="Dashboard bota">
  <meta property="og:description" content="Nastav si vlastního Discord bota přes dashboard">
  <link rel="icon" href="https://raw.githubusercontent.com/Imagineoff/projectS/main/IMG_2609.jpeg">
  <style>
    /* Základní reset a font */
    * { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', sans-serif; transition: all 0.3s ease; }
    body { background-color: #fff; color: #111; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding: 2rem; }
    a { color: inherit; text-decoration: none; }

    /* Logo / hlavička */
    header { display: flex; align-items: center; justify-content: space-between; width: 100%; max-width: 800px; margin-bottom: 2rem; }
    header h1 { font-size: 2rem; font-weight: 600; }

    /* Tlačítko tmavého režimu */
    #darkModeToggle { cursor: pointer; padding: 0.5rem 1rem; border: 2px solid #111; border-radius: 8px; background: none; font-weight: 500; }
    #darkModeToggle:hover { background-color: #111; color: #fff; }

    /* Login a nastavení */
    #login, #settings { width: 100%; max-width: 600px; background: #f9f9f9; border: 2px solid #111; border-radius: 16px; padding: 2rem; display: flex; flex-direction: column; gap: 1.5rem; box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
    #settings { display: none; }

    button, select, textarea { font-family: inherit; font-size: 1rem; border-radius: 8px; padding: 0.5rem; border: 1px solid #111; outline: none; }

    button { cursor: pointer; font-weight: 600; background-color: #111; color: #fff; border: none; }
    button:hover { background-color: #333; }

    select, textarea { width: 100%; }

    textarea { resize: vertical; }

    /* Animace při hover a fade-in */
    #login a, button { transform: translateY(0); transition: transform 0.3s ease, background-color 0.3s ease; }
    #login a:hover, button:hover { transform: translateY(-3px); }

    /* Dark mode */
    body.dark { background-color: #111; color: #f9f9f9; }
    body.dark #login, body.dark #settings { background: #222; border-color: #f9f9f9; }
    body.dark button { background-color: #f9f9f9; color: #111; }
    body.dark button:hover { background-color: #ddd; }
    body.dark select, body.dark textarea { background-color: #333; color: #f9f9f9; border-color: #f9f9f9; }
  </style>
</head>
<body>
  <header>
    <h1>Dashboard bota</h1>
    <button id="darkModeToggle">🌙 Tmavý režim</button>
  </header>

  <!-- Login -->
  <div id="login">
    <a href="https://discord.com/oauth2/authorize?client_id=1367537434480480316&redirect_uri=https%3A%2F%2Fsentinel-discord-bot.netlify.app%2Fcallback&response_type=code&scope=identify%20guilds">
      Přihlásit se přes Discord
    </a>
  </div>

  <!-- Nastavení -->
  <div id="settings">
    <h2 id="welcome"></h2>
    <form id="settingsForm">
      <label>Styl odpovědi:</label>
      <select name="style">
        <option value="normal">Normální</option>
        <option value="funny">Vtipný</option>
        <option value="serious">Seriózní</option>
      </select>

      <label>Vlastní prompt:</label>
      <textarea name="prompt" rows="5" placeholder="Napiš, jak se má bot chovat..."></textarea>

      <button type="submit">Uložit</button>
    </form>
  </div>

  <script>
    // Dark mode toggle
    const toggle = document.getElementById("darkModeToggle");
    toggle.addEventListener("click", () => {
      document.body.classList.toggle("dark");
    });

    // Discord user login z URL
    const params = new URLSearchParams(window.location.search);
    if (params.has("user")) {
      const user = JSON.parse(decodeURIComponent(params.get("user")));
      localStorage.setItem("discordUser", JSON.stringify(user));
      window.history.replaceState({}, document.title, "/");
    }

    const user = localStorage.getItem("discordUser");
    if (user) {
      document.getElementById("login").style.display = "none";
      document.getElementById("settings").style.display = "flex";
      document.getElementById("welcome").innerText = "Přihlášen jako " + JSON.parse(user).username;
    }

    document.getElementById("settingsForm")?.addEventListener("submit", async (e) => {
      e.preventDefault();
      const style = e.target.style.value;
      const prompt = e.target.prompt.value;

      await fetch("/.netlify/functions/saveSettings", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ style, prompt }),
      });

      alert("Nastavení uloženo!");
    });
  </script>
</body>
</html>
